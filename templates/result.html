<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results for {{ domain }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>Results for {{ domain }}</h1>
    
    <h2>Website Information</h2>
    <p><strong>Title:</strong> {{ info.title }}</p>
    <p><strong>Description:</strong> {{ info.description }}</p>
    
    <h2>Generated Marketing Prompts</h2>
    <ol>
    {% for prompt in prompts %}
        <li>{{ prompt }}</li>
    {% endfor %}
    </ol>
    
    <h2>Prompt Analysis</h2>
    <table>
        <thead>
            <tr>
                <th>Prompt</th>
                <th>Answer</th>
                <th>Top Competitors</th>
                <th>Are you visible in LLM results?</th>
            </tr>
        </thead>
        <tbody>
        {% for row in table %}
            <tr>
                <td class="truncate">{{ row.prompt }}</td>
                <td class="truncate">{{ row.answer }}</td>
                <td>
                    {% if row.competitors != 'None mentioned' %}
                        <ul>
                            {% for competitor in row.competitors.split(', ') %}
                                <li>{{ competitor }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        {{ row.competitors }}
                    {% endif %}
                </td>
                <td>{{ row.visible }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    
    <div class="cta-container">
        {% if show_waiting_list %}
            <a href="https://form.typeform.com/to/YOUR_TYPEFORM_ID" target="_blank" class="cta-button waiting-list-button">Join Waiting List</a>
        {% else %}
            <a href="/" class="cta-button">Generate More Prompts</a>
        {% endif %}
    </div>

    <script>
        // This script will only show the "Join Waiting List" button after the first search
        if (sessionStorage.getItem('searchPerformed') !== 'true') {
            sessionStorage.setItem('searchPerformed', 'true');
            document.querySelector('.waiting-list-button').style.display = 'none';
        }
    </script>
</body>
</html>
