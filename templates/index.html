<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Search Performance Tracker</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9B4WW61DS4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9B4WW61DS4');
    </script>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üîç</text></svg>">
</head>
<body>
    <h1>LLM Search Performance Tracker</h1>
    
    <main>
        <section class="intro">
            <h2>Stay Seen in the New Search World</h2>
            <p>Search is changing from Google to new smart helpers called LLMs. It is important to know where your brand shows up in these new searches. Our tool helps you see where you are in these searches, so you can stay easy to find and ahead of others.</p>
        </section>

        <section class="how-it-works">
            <h2>How It Works</h2>
            <ol>
                <li><strong>Enter Your Website:</strong> Type in your website domain (e.g., example.com).</li>
                <li><strong>Analyze Content:</strong> We look at your website and find things people might search for about you.</li>
                <li><strong>Simulate Search Results:</strong> Our AI shows what the LLM helper will say when people search for those things.</li>
                <li><strong>Review Visibility:</strong> See where you show up and compare to others.</li>
            </ol>
        </section>

        {% if error %}
        <section class="error-message">
            <p class="error">{{ error }} Try another website.</p>
        </section>
        {% endif %}

        {% if searches_left > 0 %}
        <section class="cta">
            <p class="cta-text">Don't let your brand get lost in the new search world. Start tracking your visibility today and find ways to improve. ({{ searches_left }} free searches left)</p>
            <form method="post" id="promptForm">
                <input type="text" name="domain" id="domainInput" placeholder="Enter your website domain (e.g., example.com)" required>
                <input type="submit" value="Get Started Now" class="cta-button">
            </form>
            <div class="spinner" id="spinner"></div>
            <div id="progress-log"></div>
        </section>
        {% else %}
        <section class="cta">
            <p class="cta-text">You've used all your free searches. Want to unlock more insights and make your brand even better?</p>
            <div class="cta-container">
                <a href="https://mv71z3xpmnl.typeform.com/to/bmN8bM2y" target="_blank" class="cta-button waiting-list-button">Join the Waiting List for More Access</a>
            </div>
        </section>
        {% endif %}
    </main>

    <script>
        function extractDomain(url) {
            url = url.replace(/^(?:https?:\/\/)?(?:www\.)?/i, "");
            url = url.split('/')[0];
            return url;
        }

        function updateProgress(message) {
            const progressLog = document.getElementById('progress-log');
            progressLog.innerHTML += `<p>${message}</p>`;
        }

        document.getElementById('promptForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            var domainInput = document.getElementById('domainInput');
            domainInput.value = extractDomain(domainInput.value);
            document.getElementById('spinner').style.display = 'block';
            document.getElementById('progress-log').innerHTML = ''; // Clear previous logs
            this.style.display = 'none';

            updateProgress('Fetching website content...');

            // Simulate progress updates (you can't get real-time updates from the server without WebSockets)
            setTimeout(() => updateProgress('Analyzing content...'), 3000);
            setTimeout(() => updateProgress('Generating prompts...'), 6000);
            setTimeout(() => updateProgress('Simulating LLM responses...'), 9000);

            this.submit();
        });
    </script>
</body>
</html>
