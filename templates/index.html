<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Search Performance Tracker</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9B4WW61DS4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9B4WW61DS4');
    </script>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üîç</text></svg>">
</head>
<body>
    <header class="hero">
        <h1><i class="fas fa-search icon-large" aria-hidden="true"></i>LLM Search Performance Tracker</h1>
        <p>Discover your brand's visibility in AI-powered search results</p>
        <p class="user-count"><i class="fas fa-users icon-small" aria-hidden="true"></i>{{ user_count }} users have improved their LLM visibility</p>
        {% if searches_left > 0 %}
        <form method="post" id="promptForm" class="hero-form">
            <label for="domainInput" class="sr-only">Enter your website domain</label>
            <input type="text" name="domain" id="domainInput" placeholder="Enter your website domain (e.g., example.com)" required aria-required="true">
            <button type="submit" class="cta-button"><i class="fas fa-rocket icon-small" aria-hidden="true"></i>Analyze Now</button>
        </form>
        <p class="cta-text">{{ searches_left }} free searches left</p>
        <div class="spinner" id="spinner" aria-hidden="true"></div>
        <div id="progress-log" aria-live="polite"></div>
        {% else %}
        <p class="cta-text"><i class="fas fa-star icon-small" aria-hidden="true"></i>You've used all your free searches. Want to unlock more insights?</p>
        <a href="https://mv71z3xpmnl.typeform.com/to/bmN8bM2y" target="_blank" class="cta-button waiting-list-button"><i class="fas fa-list-alt icon-small" aria-hidden="true"></i>Join the Waiting List</a>
        {% endif %}
    </header>
    
    {% if error %}
    <section class="error-message">
        <p class="error"><i class="fas fa-exclamation-triangle icon-small"></i>{{ error }}</p>
    </section>
    {% endif %}
    
    <main>
        <section class="intro">
            <h2><i class="fas fa-eye icon-large"></i>Stay Seen in the New Search World</h2>
            <p>Search is changing from Google to new smart helpers called LLMs. It is important to know where your brand shows up in these new searches. Our tool helps you see where you are in these searches, so you can stay easy to find and ahead of others.</p>
            {% if searches_left > 0 %}
            <a href="#" class="cta-button-secondary" onclick="document.getElementById('domainInput').focus(); return false;">Try it Now</a>
            {% endif %}
        </section>

        <section class="how-it-works">
            <h2><i class="fas fa-cogs icon-large"></i>How It Works</h2>
            <ol>
                <li><i class="fas fa-globe icon-small"></i><strong>Enter Your Website:</strong> Type in your website domain (e.g., example.com).</li>
                <li><i class="fas fa-chart-bar icon-small"></i><strong>Analyze Content:</strong> We look at your website and find things people might search for about you.</li>
                <li><i class="fas fa-robot icon-small"></i><strong>Simulate Search Results:</strong> Our AI shows what the LLM helper will say when people search for those things.</li>
                <li><i class="fas fa-check-circle icon-small"></i><strong>Review Visibility:</strong> See where you show up and compare to others.</li>
            </ol>
        </section>

        <section class="sample-result">
            <h3><i class="fas fa-chart-line icon-large"></i>Sample Result for ebay.com</h3>
            <p>This table shows an example of what our tool provides. It demonstrates how your website might appear in AI-powered search results for different queries, and how it compares to competitors.</p>
            <table class="sample-table">
                <thead>
                    <tr>
                        <th>
                            Prompt
                            <span class="tooltip">
                                <i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The search query or question that a user might ask an AI assistant.</span>
                            </span>
                        </th>
                        <th>
                            Top Competitors
                            <span class="tooltip">
                                <i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Other websites mentioned in the AI's response to the prompt.</span>
                            </span>
                        </th>
                        <th>
                            Visible in LLM?
                            <span class="tooltip">
                                <i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Whether your website appears in the AI's response, and if so, its ranking among competitors.</span>
                            </span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Best online shopping platforms</td>
                        <td>amazon.com, ebay.com</td>
                        <td class="sample-visible">Yes (Rank: 2)</td>
                    </tr>
                    <tr>
                        <td>Reliable e-commerce websites</td>
                        <td>amazon.com, walmart.com</td>
                        <td class="sample-not-visible">No</td>
                    </tr>
                    <tr>
                        <td>Where to buy used electronics online</td>
                        <td>ebay.com, bestbuy.com</td>
                        <td class="sample-visible">Yes (Rank: 1)</td>
                    </tr>
                </tbody>
            </table>
            <p>Interpretation: In this example, ebay.com appears in AI responses for 2 out of 3 queries. It ranks 2nd for "Best online shopping platforms" and 1st for "Where to buy used electronics online". However, it doesn't appear in results for "Reliable e-commerce websites", which might be an area for improvement.</p>
        </section>
    </main>

    <footer style="text-align: center; padding: 20px 0;">
        <p>&copy; 2024 LLM Search Performance Tracker. All rights reserved.</p>
        <nav>
            <a href="{{ url_for('privacy_policy') }}">Privacy Policy</a> |
            <a href="{{ url_for('terms_of_service') }}">Terms of Service</a> |
            <a href="mailto:{{ contact_email }}">Contact Us</a>
        </nav>
    </footer>

    <a href="#" id="back-to-top" class="back-to-top" aria-label="Back to top">
        <i class="fas fa-chevron-up" aria-hidden="true"></i>
    </a>

    <script>
        function extractDomain(url) {
            url = url.replace(/^(?:https?:\/\/)?(?:www\.)?/i, "");
            url = url.split('/')[0];
            return url;
        }

        function updateProgress(message) {
            const progressLog = document.getElementById('progress-log');
            progressLog.innerHTML += `<p>${message}</p>`;
        }

        document.getElementById('promptForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            var domainInput = document.getElementById('domainInput');
            domainInput.value = extractDomain(domainInput.value);
            document.getElementById('spinner').style.display = 'block';
            document.getElementById('progress-log').innerHTML = ''; // Clear previous logs
            this.querySelector('button').style.display = 'none';

            updateProgress('Fetching website content...');

            // Simulate progress updates (you can't get real-time updates from the server without WebSockets)
            setTimeout(() => updateProgress('Analyzing content...'), 3000);
            setTimeout(() => updateProgress('Generating prompts...'), 6000);
            setTimeout(() => updateProgress('Simulating LLM responses...'), 9000);

            // Set a client-side timeout
            var timeout = setTimeout(() => {
                document.getElementById('spinner').style.display = 'none';
                document.getElementById('progress-log').innerHTML += '<p>Request timed out. Please try again or try another domain.</p>';
                this.querySelector('button').style.display = 'inline-block';
            }, 25000);  // 25 seconds timeout

            fetch(this.action, {
                method: 'POST',
                body: new FormData(this)
            }).then(response => {
                clearTimeout(timeout);
                return response.text();
            }).then(html => {
                document.open();
                document.write(html);
                document.close();
            }).catch(error => {
                clearTimeout(timeout);
                console.error('Error:', error);
                document.getElementById('spinner').style.display = 'none';
                document.getElementById('progress-log').innerHTML += '<p>An error occurred. Please try again.</p>';
                this.querySelector('button').style.display = 'inline-block';
            });
        });

        // Back to top button functionality
        var backToTopButton = document.getElementById("back-to-top");
        window.onscroll = function() {scrollFunction()};

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                backToTopButton.style.display = "block";
            } else {
                backToTopButton.style.display = "none";
            }
        }

        backToTopButton.onclick = function() {
            document.body.scrollTop = 0; // For Safari
            document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }
    </script>
</body>
</html>